<div class="header__mobile-menu">
  <div x-data="{
          open: false,
          toggle() {
              if (this.open) {
                  return this.close()
              }
              this.$refs.button.focus()
              this.open = true
          },
          close(focusAfter) {
              if (! this.open) return
              this.open = false
              focusAfter && focusAfter.focus()
          }
      }"
    x-on:keydown.escape.prevent.stop="close($refs.button)"
    x-on:focusin.window="! $refs.panel.contains($event.target) && close()"
    class="header__mobile-menu-wrapper"
  >
      <button
          x-ref="button"
          x-on:click="toggle()"
          :aria-expanded="open"
          :aria-controls="$id('dropdown-button')"
          type="button"
          class="header__mobile-menu-button"
      >
          {{ 'icon-menu.svg' | inline_asset_content }}
      </button>
      <template x-teleport="header">
        <div 
          class="header__mobile-menu-backdrop"
          x-ref="panel"
          x-show="open"
          x-collapse.origin.top.left
          x-on:click.outside="close($refs.button)"
          x-cloak
        >
          <ul
            x-show="open"
            x-transition.duration.600ms
            role="menu"
            class="header__mobile-menu-list"
          >
          {% for link in section.settings.menu.links %}
            <li>
              {{ link.title | link_to: link.url }}
            </li>
          {% endfor %}
          </ul>
        </div>
      </template>
  </div>
</div>