{% assign items = 'cart.items' | t %}
{% assign item = 'cart.item' | t %}

<div class="shopify-section">
  <div class="page full-width">
    <div class="page__content">
      <div class="page__inner">
        <h1 class="page__title">
          {{ 'cart.title' | t }}
          {% if cart.item_count > 1 %}
            <span>({{ cart.item_count | append: ' ' | append: items }})</span>
          {% else %}
            <span>({{ cart.item_count | append: ' ' | append: item }})</span>
          {% endif %}
        </h1>
        {% if cart.item_count > 0 %}
          <div class="cart">
            {% for item in cart.items %}
              <div class="cart__item">
                <div class="cart__item--image">
                  <img 
                    src="{{ item.image | image_url: width: 80, height: 80 }}" 
                    alt="{{ item.image.alt | escape }}" 
                    class="rounded-lg"
                    loading="lazy"
                    width="80"
                    height="80"
                  />
                </div>
                <div class="cart__item--details">
                  <h2 class="cart__item--title">
                    <a href="{{ item.url }}">
                      {{ item.product.title }}
                    </a>
                  </h2>
                  {% render 'cart-variants', product: item.product, variant: item.variant %}
                  <div class="cart__item--quantity">
                    <form 
                        method="post" 
                        action="/cart/change" 
                        class="cart__qty-form"
                    >
                        <input 
                          type="hidden" 
                          name="id" 
                          value="{{ item.key }}"
                        >
                        <input 
                          type="number" 
                          name="quantity" 
                          value="{{ item.quantity }}" 
                          min="0" 
                          class="input--qty"
                        >
                        <div class="cart__item--actions">
                          {% render 'button',
                            type: 'submit',
                            label: 'cart.update' | t, 
                            variant: 'secondary',
                            extra_class: 'btn--w-full'
                          %}
                          {% render 'button',
                            link: item.url_to_remove,
                            label: 'cart.remove' | t,
                            variant: 'danger',
                            extra_class: 'btn--w-full'
                          %}
                        </div>
                    </form>
                  </div>
                </div>
                <div class="cart__item--price">
                  {{ 'cart.total' | t }}: <strong>{{ item.final_line_price | money }}</strong>
                </div>
              </div>
            {% endfor %}
          </div>
          <div class="cart__footer">
            <div class="cart__total">
                <span>
                  Subtotal:
                </span>&nbsp;
                <strong>
                  {{ cart.total_price | money }}
                </strong>
            </div>
            <form 
              action="/checkout" 
              method="post"
            >
              {% render 'button', 
                type: 'submit',
                label: 'cart.checkout' | t,
                variant: 'primary'
              %}
            </form>
          </div>
        {% else %}
          <div>
            {{ 'cart.empty' | t }}
          </div>
          {% render 'button', 
            href: 'collections/new', 
            label: 'cart.shopping' | t, 
            variant: 'primary' 
          %}
        {% endif %}
      </div>
    </div>
  </div>
</div>
